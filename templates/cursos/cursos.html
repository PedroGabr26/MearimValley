{% extends 'base.html' %}
{% load static %}

{% block title %}Cursos - Mearim Valley{% endblock %}

{% block content %}
<h2>PÃ¡gina de Cursos</h2>
<section id="cursos" class="fundo-verde" role="region" aria-labelledby="cursos-titulo" style="margin-top: 110px;">
  <div class="titulo-secao">
    <hr>
    <h2 id="cursos-titulo">Cursos ofertados</h2>
    <hr>
  </div>
  <div class="parceiros-grid" id="lista-cursos">
    <!-- Cursos serÃ£o inseridos via JavaScript -->
  </div>
</section>
{% endblock %}

{% block script %}
<script>
  const container = document.getElementById('lista-cursos')

  async function GetCursos() {
    const url = 'http://127.0.0.1:8000/api/cursos/'
    try {
      const resp = await fetch(url)
      if (resp.ok) {
        const data = await resp.json()
        data.forEach(curso => {
          const div = document.createElement('div')
          div.classList.add('parceiro-box')

          div.innerHTML = `
            <div style="height:100px; display:flex; align-items:center; justify-content:center; background:#eee;">
              ðŸ“˜ Curso
            </div>
            <h3>${curso.titulo}</h3>
            <p><strong>Data de criaÃ§Ã£o:</strong> ${curso.data_criacao}</p>
            <p>
              <a href="${curso.link}" target="_blank" rel="noopener noreferrer">
                Acessar curso
              </a>
            </p>
          `
          container.appendChild(div)
        })
      } else {
        container.innerHTML = '<p>Erro ao carregar cursos.</p>'
      }
    } catch (e) {
      console.error(e)
      container.innerHTML = '<p>Erro na conexÃ£o com a API.</p>'
    }
  }

  GetCursos()
</script>
{% endblock %}
